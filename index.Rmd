---
title: "Text Analysis of Biden and Trump Speeches During the 2020 Presidential Election"
author: "Conrad Kuklinsky, Jett Knight, Lovemore Nyaumwe"
date: "5/11/21"
output:
  rmdformats::readthedown:
    thumbnails: false
    highlight: NULL
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align="center")
library(tidyverse)
library(ggnetwork)
library(igraph)
```

# Network Visualizations

Biden:

```{r, echo=FALSE}
biden_network_data <- read_csv("biden_speeches_network_data.csv") %>%
  arrange(desc(weight)) %>%
  top_n(50)

biden_network <- graph_from_data_frame(biden_network_data, directed = FALSE)

V(biden_network)$degree <- igraph::degree(biden_network)
V(biden_network)$wtdegree <- strength(biden_network, weights=E(biden_network)$Weight)

stats <- data_frame(name = V(biden_network)$name,
                   degree = V(biden_network)$degree,
                   wtdegree = V(biden_network)$wtdegree )

stats <- stats %>%
  mutate(eigen = eigen_centrality(biden_network, directed = FALSE, 
                                 weights = NA)$vector, 
         page.rank = page_rank(biden_network, directed = FALSE, weights = NA)$vector
         )

ggplot(data = ggnetwork(biden_network)
       , aes(x = x, y = y, xend = xend, yend = yend)) +
  geom_edges(arrow=arrow(type="closed", length=unit(6,"pt"))
            , aes(color = weight),
            size = 2) +
  geom_nodes() +
  geom_nodelabel(aes(label = name)) +
  theme_blank() +
  ggtitle("Common Biden Speech Words") + 
  labs(size = "Weight") +
  scale_color_continuous(type = "viridis")
```

Trump:
```{r}
trump_network_data <- read_csv("trump_speeches_network_data.csv")
```


## Including links and images

You can include [Links](https://www.datadreaming.org/post/r-markdown-theme-gallery/) and images ![team logo](https://raw.githubusercontent.com/stat231-s21/Blog-Election-Pundits/main/images/s2g7-politics.jpg)

You can embed a gif.

![pugs](https://media.giphy.com/media/XHVmD4RyXgSjd8aUMb/giphy.gif)

