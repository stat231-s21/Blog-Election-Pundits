---
title: "Text Analysis of Biden and Trump Speeches During the 2020 Presidential Election"
author: "Conrad Kuklinsky, Jett Knight, Lovemore Nyaumwe"
date: "5/11/21"
output:
  rmdformats::readthedown:
    thumbnails: false
    highlight: NULL
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message= FALSE, warning=FALSE, fig.align="center")
library(tidyverse)
library(ggnetwork)
library(igraph)
library(janitor)
library(wordcloud2)
library(tidytext)
library(textdata)
```

# Introduction

The United States presidential election is one of the most followed political events in the world. As such, there are many who study the data involved in the hopes of both making predictions and informing the public on the current state of the election. In this blog post, we analyze data from a key component of the election process: speeches given by the candidates. In particular, we analyze text from speeches given by Joe Biden and Donald Trump during the lead up to the 2020 election. Our primary questions we hoped to answer were:

1. What are the most common words and phrases used by Trump and Biden? 
2. What are the relationships between those words/phrases? 
3. How did the frequency of these words/phrases change over time?

# Data



# Visualizations

In order to address our three posed questions, we created three types of visualizations, one for each question. To identify the most frequent words used in their speeches, we created wordclouds with fontsize corresponding to word frequency. To identify relationships between the words, we created network graphs with edge sizes corresponding to "closeness" of these words within the documents. (We will define "closeness" in the network section). Lastly, we created line graphs to identify changes in word frequencies over time.

## Word Frequency Wordclouds

```{r}
# reading in the speech data
trump_data <- "trump_speeches/trump_speeches_wordcloud.csv"
biden_data <- "biden_speeches/biden_speeches_wordcloud.csv"
```

```{r}
# Create a list of custom stopwords that should be added
word <- c("i’ve", "it’s", "i’m", "he’s", "let’s",
          "won’t", "we’re", "you’re", "that’s","we’ve", "don’t", "you’ve")
lexicon <-  rep("custom", times=length(word))

# Create a dataframe from the two vectors above
mystopwords <- data.frame(word, lexicon)
names(mystopwords) <- c("word", "lexicon")

# Add the dataframe to stop_words df that exists in the library stopwords
stop_words2 <-  dplyr::bind_rows(stop_words, mystopwords) %>%
  mutate(word = str_replace_all(word, "'","’"))
```


```{r}
# function to draw word cloud
dscore<-function(data){
  # read in the data into speeches and remove missing rows.
  speeches <- read_csv(data) %>%
    filter(text != "Missing")
  
  word_frequencies <- speeches %>%
    unnest_tokens(output = word, input = text) %>%
    anti_join(stop_words2, by="word") %>%
    count(word, sort = TRUE)
  
  wordcloud2(word_frequencies, shape = "star")

}

# calls the word cloud function to draw two word clouds
dscore(trump_data)
dscore(biden_data)
```


## Network Visualizations

To understand the relationships between speech words, we looked at two types of words: the most common words across all speeches and popular election topics such as climate change, health care, and COVID-19. For each of these sets, we needed to define some metric for "closeness". To do this, we emulated an [analysis of Game of Thrones](https://networkofthrones.wordpress.com/). Specifically, we defined the closeness of two words (within the full dataset) as the number of times that the words occur within *d* words of each other in a single speech, where *d* is a parameter specifying this word distance. For the first set of words (the most common words across all speeches), we chose *d* to be 10 (a relatively low value) since the words considered are more generic in nature (than the other set of words), and therefore a lower choice of *d* will pick up on more significant relationships. On the other hand, we chose *d* to be 50 for the popular election topics. Since the specific words involved in these topics occur much less frequently than the most common words, we needed to choose a larger value of *d* to capture these relationships.

### Text Mining

Talk about Python here (and include non-runnable chunk)

### Network Analysis for Most Commonly Used Words

```{r}
biden_network_data <- read_csv("biden_speeches_network_data_no_topics.csv") %>%
  arrange(desc(weight)) %>%
  top_n(16) %>%
  filter(!(word1 == "good" & word2 == "jobs") & !(word2 == "good" & word1 == "jobs"))

biden_network <- graph_from_data_frame(biden_network_data, directed = FALSE)

V(biden_network)$degree <- igraph::degree(biden_network)
V(biden_network)$wtdegree <- strength(biden_network, weights=E(biden_network)$Weight)

stats <- data_frame(name = V(biden_network)$name,
                   degree = V(biden_network)$degree,
                   wtdegree = V(biden_network)$wtdegree )

stats <- stats %>%
  mutate(eigen = eigen_centrality(biden_network, directed = FALSE, 
                                 weights = NA)$vector, 
         page.rank = page_rank(biden_network, directed = FALSE, weights = NA)$vector
         )

ggplot(data = ggnetwork(biden_network)
       , aes(x = x, y = y, xend = xend, yend = yend)) +
  geom_edges(arrow=arrow(type="closed", length=unit(6,"pt"))
            , color = "lightgray", aes(size = weight)) +
  geom_nodes() +
  geom_nodelabel(aes(label = name)) +
  theme_blank() +
  ggtitle("Relationships Among Common Words in Biden's Speeches") + 
  labs(size = "Relationship Strength")
```

```{r}
trump_network_data <- read_csv("trump_speeches_network_data_no_topics.csv") %>%
  arrange(desc(weight)) %>%
  top_n(16)

trump_network <- graph_from_data_frame(trump_network_data, directed = FALSE)

V(trump_network)$degree <- igraph::degree(trump_network)
V(trump_network)$wtdegree <- strength(biden_network, weights=E(biden_network)$Weight)

stats <- data_frame(name = V(trump_network)$name,
                   degree = V(trump_network)$degree,
                   wtdegree = V(trump_network)$wtdegree )

stats <- stats %>%
  mutate(eigen = eigen_centrality(trump_network, directed = FALSE, 
                                 weights = NA)$vector, 
         page.rank = page_rank(trump_network, directed = FALSE, weights = NA)$vector
         )

ggplot(data = ggnetwork(trump_network)
       , aes(x = x, y = y, xend = xend, yend = yend)) +
  geom_edges(arrow=arrow(type="closed", length=unit(6,"pt"))
            , color = "lightgray", aes(size = weight)) +
  geom_nodes() +
  geom_nodelabel(aes(label = name)) +
  theme_blank() +
  ggtitle("Relationships Among Common Words in Biden's Speeches") + 
  labs(size = "Relationship Strength")
```

### Network Analysis for Popular Election Topics:


```{r, echo=FALSE, message=FALSE}
biden_network_data <- read_csv("biden_speeches_network_data.csv") %>%
  arrange(desc(weight)) %>%
  top_n(16)

biden_network <- graph_from_data_frame(biden_network_data, directed = FALSE)

V(biden_network)$degree <- igraph::degree(biden_network)
V(biden_network)$wtdegree <- strength(biden_network, weights=E(biden_network)$Weight)

stats <- data_frame(name = V(biden_network)$name,
                   degree = V(biden_network)$degree,
                   wtdegree = V(biden_network)$wtdegree )

stats <- stats %>%
  mutate(eigen = eigen_centrality(biden_network, directed = FALSE, 
                                 weights = NA)$vector, 
         page.rank = page_rank(biden_network, directed = FALSE, weights = NA)$vector
         )

ggplot(data = ggnetwork(biden_network)
       , aes(x = x, y = y, xend = xend, yend = yend)) +
  geom_edges(arrow=arrow(type="closed", length=unit(6,"pt"))
            , color = "lightgray", aes(size = weight)) +
  geom_nodes() +
  geom_nodelabel(aes(label = name)) +
  theme_blank() +
  ggtitle("Topic Relationships in Biden's Speeches") + 
  labs(size = "Relationship Strength")
```

```{r}
trump_network_data <- read_csv("trump_speeches_network_data.csv") %>%
  arrange(desc(weight)) %>%
  top_n(16)

trump_network <- graph_from_data_frame(trump_network_data, directed = FALSE)

V(trump_network)$degree <- igraph::degree(trump_network)
V(trump_network)$wtdegree <- strength(biden_network, weights=E(biden_network)$Weight)

stats <- data_frame(name = V(trump_network)$name,
                   degree = V(trump_network)$degree,
                   wtdegree = V(trump_network)$wtdegree )

stats <- stats %>%
  mutate(eigen = eigen_centrality(trump_network, directed = FALSE, 
                                 weights = NA)$vector, 
         page.rank = page_rank(trump_network, directed = FALSE, weights = NA)$vector
         )

ggplot(data = ggnetwork(trump_network)
       , aes(x = x, y = y, xend = xend, yend = yend)) +
  geom_edges(arrow=arrow(type="closed", length=unit(6,"pt"))
            , color = "lightgray", aes(size = weight)) +
  geom_nodes() +
  geom_nodelabel(aes(label = name)) +
  theme_blank() +
  ggtitle("Topic Relationships in Trump's Speeches") + 
  labs(size = "Relationship Strength")
```

## Speech Analysis Over Time

```{r}
#Reading in csv files
biden_linegraph_words3 <- read_csv("biden_linegraph_data.csv")

trump_linegraph_words3<- read_csv("trump_linegraph_data.csv")
```

```{r}
#Linegraphs 1-2: Analysis of the word 'America' over time
biden_linegraph_words3 %>%
  filter(word == "america") %>%
  ggplot(aes(x = as.Date(file, "%m-%d-%y"), y = n)) + 
geom_line(color = "blue", size = 0.5) + geom_point(color = "blue") + 
labs(title = "Biden's use of the word 'America' over time.", 
x = "Date", y = "Word Frequency per Day") + theme_minimal()

trump_linegraph_words3 %>%
  filter(word == "america") %>%
  ggplot(aes(x = as.Date(file, "%m-%d-%y"), y = n)) + 
geom_line(color = "red", size = 0.5) + geom_point(color = "red") + 
labs(title = "Trump's use of the word 'America' over time.", 
x = "Date", y = "Word Frequency per Day") + theme_minimal()

#We can see that Biden's use of the word 'America' remains relatively consistent over the last stage of his campaigning. A noticeable outlier towards the end is in his victory speech in early 2021.

#We can also see that Trump used the word 'America' a similar amount that Biden did during his campaigning. However, we can see a noticeable decrease corresponding with when Joe Biden defeated him in the general election.
```

```{r}
#Linegraphs 3-4: Analysis of the word 'President' over time
biden_linegraph_words3 %>%
  filter(word == "president") %>%
  ggplot(aes(x = as.Date(file, "%m-%d-%y"), y = n)) + 
geom_line(color = "blue", size = 0.5) + geom_point(color = "blue") + 
labs(title = "Biden's use of the word 'president' over time.", 
x = "Date", y = "Word Frequency per Day") + theme_minimal()

trump_linegraph_words3 %>%
  filter(word == "president") %>%
  ggplot(aes(x = as.Date(file, "%m-%d-%y"), y = n)) + 
geom_line(color = "red", size = 0.5) + geom_point(color = "red") + 
labs(title = "Trump's use of the word 'president' over time.", 
x = "Date", y = "Word Frequency per Day") + theme_minimal()

#Biden used the word 'president' a similar amount of times, and again we see a noticeable outlier corresponding with his victory speech.

#There is not a statistically significant difference between the amount of times Biden and Trump used the word 'president'. As before though, we see this drops off somewhat after the general election.
```

```{r}
#Linegraphs 5-6: Analysis of the word 'Virus' over time
biden_linegraph_words3 %>%
  filter(word == "virus") %>%
  ggplot(aes(x = as.Date(file, "%m-%d-%y"), y = n)) + 
geom_line(color = "blue", size = 0.5) + geom_point(color = "blue") + 
labs(title = "Biden's use of the word 'virus' over time.", 
x = "Date", y = "Word Frequency per Day") + theme_minimal()

trump_linegraph_words3 %>%
  filter(word == "virus") %>%
  ggplot(aes(x = as.Date(file, "%m-%d-%y"), y = n)) + 
geom_line(color = "red", size = 0.5) + geom_point(color = "red") + 
labs(title = "Trump's use of the word 'virus' over time.", 
x = "Date", y = "Word Frequency per Day") + theme_minimal()

#Trump and Biden both used the term 'virus' a similar amount during their public appearances. We see Biden mentioned it a lot during the start of the Covid-19 pandemic, and again during his victory speech. Again, Trump mentioned it fairly consistently, until his defeat by Biden at which point he would rarely talk about it.
```

# Limitations, Pitfalls, and Future Research

While we feel like we adequately answered our specific questions, it's definitely hard to make inference outside of that with larger questions, like how their different speech patterns contributed to the 2020 election. One interesting idea for future research is to analyze sentiment in their text, to determine the tone of language used and how that could shift over time.

## links and images

You can include [Links](https://www.datadreaming.org/post/r-markdown-theme-gallery/) and images ![team logo](https://raw.githubusercontent.com/stat231-s21/Blog-Election-Pundits/main/images/s2g7-politics.jpg)

You can embed a gif.

![pugs](https://media.giphy.com/media/XHVmD4RyXgSjd8aUMb/giphy.gif)

